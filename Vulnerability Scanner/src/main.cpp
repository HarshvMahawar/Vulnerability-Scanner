#include "scanner.hpp"
#include <iostream>
#include <string>

int main(int argc, char* argv[]) {
    if (argc != 4) {
        std::cerr << "Usage: " << argv[0] << " <target_ip> <start_port> <end_port>\n";
        return 1;
    }

    std::string target_ip = argv[1];
    int start_port = std::stoi(argv[2]);
    int end_port = std::stoi(argv[3]);

    if (!is_valid_ip(target_ip)) {
        std::cerr << "Invalid IP address format.\n";
        return 1;
    }

    VulnerabilityScanner scanner(target_ip);
    scanner.scan_ports(start_port, end_port);
    scanner.print_results();

    return 0;
}
